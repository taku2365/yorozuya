# Requirements Document

## Introduction
本プロジェクトは、非プログラマー向けの統合スケジュール管理ツールを提供するWebアプリケーションです。会員登録不要で利用でき、すべてのデータはSQLite WASMデータベース（ブラウザ内で動作）に保存されるため、プライバシーを保護しながら個人およびチームのスケジュール管理を支援します。一般職の方でも直感的に使えるUIを提供し、ToDo管理、WBS（作業分解構成図）、カンバンボード、ガントチャートの4つの機能を統合し、相互に連携させることで、包括的な業務効率化を実現します。

## Requirements

### Requirement 1: ToDo管理機能
**User Story:** As a 一般職の利用者, I want 日々のタスクを簡単に管理したい, so that 直感的なインターフェースでToDoを作成・編集・削除できる機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーが新規ToDoを作成する THEN システムは タイトル、説明、期限、優先度を入力できるフォームを表示する
2. IF ToDoのタイトルが空欄である THEN システムは エラーメッセージを表示し、保存を拒否する
3. WHEN ユーザーがToDoを保存する THEN システムは SQLite WASMデータベースにデータを保存し、一覧に即座に反映する
4. WHEN ユーザーがToDoをクリックする THEN システムは 編集可能な状態でToDoの詳細を表示する
5. WHEN ユーザーがToDoを完了にマークする THEN システムは 視覚的に完了状態を表示し、完了日時を記録する
6. WHERE ToDoの期限が過ぎている THE システムは 該当ToDoを赤色でハイライト表示する
7. WHEN ユーザーがToDoを削除する THEN システムは 確認ダイアログを表示し、確認後にデータベースから削除する

### Requirement 2: WBS（作業分解構成図）機能
**User Story:** As a プロジェクトマネージャー, I want 大きなタスクを階層的に分解して管理したい, so that 視覚的にタスクの親子関係を表現できるWBS機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーが新規WBSを作成する THEN システムは ルートタスクの入力フォームを表示する
2. WHEN ユーザーが親タスクを選択する THEN システムは 子タスクを追加するオプションを表示する
3. IF タスクが3階層以上の深さになる THEN システムは 警告メッセージを表示するが、作成は許可する
4. WHEN ユーザーがタスクをドラッグ&ドロップする THEN システムは タスクの階層構造を更新し、即座に画面に反映する
5. WHILE WBSを表示している THE システムは タスクの進捗率を親タスクに自動集計して表示する
6. WHEN ユーザーがタスクの見積もり時間を入力する THEN システムは 親タスクの合計時間を自動計算する
7. WHERE タスクに担当者が設定されている THE システムは 担当者名をタスクカードに表示する
8. WHEN WBSを表示する THEN システムは 1, 1.1, 1.1.1のような階層的な番号を自動的に振り、タスクの追加・削除・移動時に番号を再採番する
9. WHEN ユーザーが備考欄に入力する THEN システムは タスクの詳細説明、完了条件、進捗状況の補足情報を保存・表示する
10. WHEN ユーザーが開始日と終了日を設定する THEN システムは 営業日ベースで工数（人日）を自動計算し、工数欄に表示する
11. WHEN ユーザーがタスク間に新規タスクを挿入する THEN システムは ワンクリックで挿入ポイントを選択でき、階層番号を自動的に再採番する
12. WHILE WBSを表示している THE システムは エクセルライクなテーブル表示で、列幅の調整機能と印刷対応のレイアウトを提供する

### Requirement 3: カンバンボード機能
**User Story:** As a チームメンバー, I want タスクの進捗状況を視覚的に把握したい, so that ドラッグ&ドロップで簡単にステータスを変更できるカンバンボードが必要だ

#### Acceptance Criteria

1. WHEN ユーザーがカンバンボードを開く THEN システムは 「ToDo」「進行中」「完了」の3つの基本レーンを表示する
2. WHEN ユーザーが新規レーンを追加する THEN システムは カスタムレーン名を入力できるフォームを表示する
3. WHEN ユーザーがカードをレーン間でドラッグする THEN システムは カードの状態を更新し、移動履歴を記録する
4. IF レーンに設定されたWIP制限を超える THEN システムは 警告を表示し、カードの追加を制限する
5. WHERE カードに期限が設定されている THE システムは 期限までの残り日数を表示する
6. WHEN ユーザーがカードにラベルを追加する THEN システムは 色分けされたラベルを表示し、フィルタリングを可能にする
7. WHILE カンバンボードを表示している THE システムは 各レーンのカード数を集計して表示する

### Requirement 4: ガントチャート機能
**User Story:** As a プロジェクトマネージャー, I want タスクのスケジュールと依存関係を時系列で可視化したい, so that インタラクティブなガントチャートが必要だ

#### Acceptance Criteria

1. WHEN ユーザーがガントチャートを開く THEN システムは 現在の月を中心とした時間軸とタスク一覧を表示する
2. WHEN ユーザーがタスクバーをドラッグする THEN システムは 開始日と終了日を更新し、依存関係を維持する
3. IF タスクAがタスクBに依存している AND タスクBの日程が変更される THEN システムは タスクAの日程を自動調整する
4. WHERE クリティカルパス上のタスクである THE システムは タスクバーを赤色で強調表示する
5. WHEN ユーザーがタスク間に依存関係を設定する THEN システムは 矢印で依存関係を視覚的に表示する
6. WHILE ガントチャートを表示している THE システムは 今日の日付を縦線で表示する
7. WHEN ユーザーが表示期間を変更する THEN システムは 日/週/月/四半期の表示を切り替える
8. WHEN ユーザーがエクスポート機能を使用する THEN システムは PNG、PDF、Excel、CSV形式でガントチャートをエクスポートする

### Requirement 5: データ永続化とセキュリティ
**User Story:** As a 個人ユーザー, I want 会員登録なしで安全にデータを保存したい, so that SQLite WASMデータベースを活用した永続化機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーがデータを作成・更新する THEN システムは 即座にSQLite WASMデータベースに保存する
2. WHEN ユーザーがブラウザを再起動する THEN システムは SQLite WASMデータベースからデータを復元する
3. IF データベースの容量が50MBを超える THEN システムは 警告メッセージを表示し、古いデータのアーカイブを提案する
4. WHEN ユーザーがエクスポート機能を使用する THEN システムは JSON、CSV、Excel形式でデータをダウンロード可能にする
5. WHEN ユーザーがインポート機能を使用する THEN システムは JSONファイルからデータを読み込み、既存データとマージする
6. WHERE データベーストランザクションが失敗した THE システムは 自動的にロールバックし、エラーメッセージを表示する
7. WHEN ユーザーがデータをクリアする THEN システムは 確認ダイアログを2回表示し、誤操作を防ぐ

### Requirement 6: ユーザーインターフェース
**User Story:** As a 一般職の利用者, I want 専門知識なしで直感的に操作したい, so that わかりやすく統一されたUIが必要だ

#### Acceptance Criteria

1. WHEN ユーザーが初めてアプリを開く THEN システムは 簡単なチュートリアルを表示する
2. WHERE ユーザーが操作に迷う可能性がある THE システムは ツールチップでヒントを表示する
3. WHEN ユーザーがダークモードを選択する THEN システムは 全画面のテーマを切り替え、設定を保存する
4. IF ユーザーがモバイルデバイスでアクセスする THEN システムは レスポンシブデザインで最適化された表示を行う
5. WHILE ユーザーが長時間の操作を行っている THE システムは 自動保存インジケーターを表示する
6. WHEN ユーザーがキーボードショートカットを使用する THEN システムは 主要な操作を素早く実行する
7. WHERE エラーが発生した THE システムは ユーザーフレンドリーなメッセージと解決方法を表示する

### Requirement 7: 統合連携機能
**User Story:** As a スケジュール管理者, I want Todo、WBS、カンバン、ガントチャートを一元的に管理したい, so that 各ツール間でデータが自動的に連携し、どのビューからでも同じタスクを管理できる統合機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーがTodoでタスクを作成する THEN システムは 必要に応じてWBS、カンバン、ガントチャートにも同じタスクを表示する
2. WHEN ユーザーがWBSの最下層タスクを作成する THEN システムは 自動的にTodoリストにも追加し、期限が設定されていればガントチャートにも表示する
3. WHEN ユーザーがカンバンでカードのステータスを変更する THEN システムは 関連するTodoの完了状態、WBSの進捗率、ガントチャートの進捗を自動更新する
4. WHEN ユーザーがガントチャートで日程を変更する THEN システムは 関連するTodoの期限、WBSの開始日・終了日を自動更新する
5. WHERE タスクが複数のビューに表示されている THE システムは 各ビューに適したアイコンまたはバッジでリンク状態を表示する
6. WHEN ユーザーが統合検索を使用する THEN システムは すべてのビューのタスクを横断的に検索し、結果を統合して表示する
7. IF ユーザーがタスクをドラッグ&ドロップで別のビューに移動する THEN システムは 適切なデータ変換を行い、新しいビューに追加する
8. WHEN ユーザーがフィルタを適用する THEN システムは 現在のビューに関わらず、統一されたフィルタ条件（ステータス、優先度、担当者、期限）で絞り込む

### Requirement 8: 統合UI/UX
**User Story:** As a 一般ユーザー, I want 異なるツール間をシームレスに移動したい, so that 統一されたナビゲーションと一貫性のあるUIが必要だ

#### Acceptance Criteria

1. WHEN ユーザーがアプリケーションを開く THEN システムは 上部に統合ナビゲーションタブ（Todo｜WBS｜カンバン｜ガント）を表示する
2. WHEN ユーザーがタブを切り替える THEN システムは 0.3秒以内に新しいビューを表示し、選択状態を保持する
3. WHERE すべてのビューで THE システムは 共通のサイドバーでプロジェクト一覧、フィルタ、タグ、メンバー、カレンダーを表示する
4. WHEN ユーザーがタスクの詳細を開く THEN システムは 統一されたダイアログで、基本情報、関連、履歴、コメントのタブを表示する
5. IF ユーザーがタスクを右クリックする THEN システムは コンテキストメニューで他のビューへの追加オプションを表示する
6. WHILE ユーザーが操作している THE システムは リアルタイムで変更を保存し、他のビューにも即座に反映する
7. WHEN ユーザーが通知アイコンをクリックする THEN システムは 期限通知、ステータス変更通知などを統合して表示する

### Requirement 9: 統合データ管理
**User Story:** As a データ管理者, I want すべてのタスクデータを一元的に管理したい, so that 統一されたデータモデルと効率的な同期メカニズムが必要だ

#### Acceptance Criteria

1. WHEN システムがタスクを保存する THEN システムは 統一されたデータモデル（UnifiedTask）で、すべての属性を管理する
2. WHERE データ競合が発生した場合 THE システムは 最後の更新を優先し、変更履歴を保持する
3. WHEN ユーザーがデータをエクスポートする THEN システムは JSON、CSV、Excel形式で統合データを出力する
4. WHEN ユーザーがデータをインポートする THEN システムは 自動的にデータを解析し、適切なビューに振り分ける
5. IF データベースのサイズが50MBを超える THEN システムは 古いアーカイブデータの削除を提案する
6. WHILE システムが稼働している THE システムは データの整合性チェックを定期的に実行する
7. WHEN ユーザーが削除操作を行う THEN システムは 関連するすべてのビューからタスクを削除し、依存関係を自動調整する

### Requirement 10: 高度な統合機能（将来拡張）
**User Story:** As a パワーユーザー, I want より高度な統合機能を使いたい, so that タスクの自動連携とインテリジェントな推奨機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーがWBSで親タスクを作成する THEN システムは AIを使用して適切な子タスクを提案する
2. IF タスクの期限が近づいている AND 進捗が遅れている THEN システムは 自動的にアラートを生成し、リスケジュールを提案する
3. WHEN ユーザーが類似のタスクを複数作成する THEN システムは テンプレート化を提案し、次回から効率的に作成できるようにする
4. WHERE 複数のタスクが同じリソースを必要とする THE システムは リソース競合を検出し、最適なスケジュールを提案する
5. WHEN ユーザーがプロジェクトを完了する THEN システムは レトロスペクティブレポートを自動生成し、改善点を提示する

### Requirement 11: コラボレーション機能（将来拡張）
**User Story:** As a チームリーダー, I want メンバーと効率的に協働したい, so that リアルタイムコラボレーション機能が必要だ

#### Acceptance Criteria

1. WHEN 複数のユーザーが同じタスクを編集する THEN システムは リアルタイムで変更を同期し、競合を自動解決する
2. IF ユーザーがタスクにコメントを追加する THEN システムは 関係者に通知を送信し、スレッド形式で議論を可能にする
3. WHERE チームメンバーが作業している THE システムは 各メンバーのアクティビティをリアルタイムで表示する
4. WHEN ユーザーがタスクを共有する THEN システムは 読み取り専用または編集可能なリンクを生成する
5. WHILE チームで作業している THE システムは 変更履歴を詳細に記録し、誰がいつ何を変更したかを追跡可能にする

### Requirement 12: AI支援機能（将来拡張）
**User Story:** As a 効率的な管理者, I want AIの支援を受けてタスク管理を最適化したい, so that インテリジェントな支援機能が必要だ

#### Acceptance Criteria

1. WHEN ユーザーがタスクの説明を入力する THEN システムは 自動的に適切なタグ、優先度、予想工数を提案する
2. IF プロジェクトが遅延する可能性がある THEN システムは 機械学習により早期に検出し、対策を提案する
3. WHERE 繰り返しパターンが検出される THE システムは 自動化可能なワークフローを提案する
4. WHEN ユーザーが自然言語でタスクを入力する THEN システムは それを構造化されたタスクに変換する
5. WHILE プロジェクトが進行中 THE システムは 過去の類似プロジェクトから学習し、最適な進め方を提案する