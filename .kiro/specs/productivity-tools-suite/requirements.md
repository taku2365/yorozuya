# Requirements Document

## 概要
本プロジェクトは、非プログラマー向けの統合スケジュール管理ツールを提供するWebアプリケーションです。会員登録不要で利用でき、すべてのデータはローカルストレージに保存されるため、プライバシーを保護しながら個人およびチームのスケジュール管理を支援します。一般職の方でも直感的に使えるUIを提供し、ToDo管理、WBS（作業分解構成図）、カンバンボード、ガントチャートの4つの機能を統合し、相互に連携させることで、包括的な業務効率化を実現します。

## 要件

### 要件1: ToDo管理機能
**ユーザーストーリー:** 一般職の利用者として、日々のタスクを簡単に管理したい。そのため、直感的なインターフェースでToDoを作成・編集・削除できる機能が必要だ。

#### 受け入れ基準

1. WHEN ユーザーが新規ToDoを作成する THEN システムは タイトル、説明、期限、優先度を入力できるフォームを表示する
2. IF ToDoのタイトルが空欄である THEN システムは エラーメッセージを表示し、保存を拒否する
3. WHEN ユーザーがToDoを保存する THEN システムは ローカルストレージにデータを保存し、一覧に即座に反映する
4. WHEN ユーザーがToDoをクリックする THEN システムは 編集可能な状態でToDoの詳細を表示する
5. WHEN ユーザーがToDoを完了にマークする THEN システムは 視覚的に完了状態を表示し、完了日時を記録する
6. WHERE ToDoの期限が過ぎている THE システムは 該当ToDoを赤色でハイライト表示する
7. WHEN ユーザーがToDoを削除する THEN システムは 確認ダイアログを表示し、確認後にローカルストレージから削除する

### 要件2: WBS（作業分解構成図）機能
**ユーザーストーリー:** プロジェクトマネージャーとして、大きなタスクを階層的に分解して管理したい。そのため、視覚的にタスクの親子関係を表現できるWBS機能が必要だ。

#### 受け入れ基準

1. WHEN ユーザーが新規WBSを作成する THEN システムは ルートタスクの入力フォームを表示する
2. WHEN ユーザーが親タスクを選択する THEN システムは 子タスクを追加するオプションを表示する
3. IF タスクが3階層以上の深さになる THEN システムは 警告メッセージを表示するが、作成は許可する
4. WHEN ユーザーがタスクをドラッグ&ドロップする THEN システムは タスクの階層構造を更新し、即座に画面に反映する
5. WHILE WBSを表示している THE システムは タスクの進捗率を親タスクに自動集計して表示する
6. WHEN ユーザーがタスクの見積もり時間を入力する THEN システムは 親タスクの合計時間を自動計算する
7. WHERE タスクに担当者が設定されている THE システムは 担当者名をタスクカードに表示する
8. WHEN WBSを表示する THEN システムは 1, 1.1, 1.1.1のような階層的な番号を自動的に振り、タスクの追加・削除・移動時に番号を再採番する
9. WHEN ユーザーが備考欄に入力する THEN システムは タスクの詳細説明、完了条件、進捗状況の補足情報を保存・表示する
10. WHEN ユーザーが開始日と終了日を設定する THEN システムは 営業日ベースで工数（人日）を自動計算し、工数欄に表示する
11. WHEN ユーザーがタスク間に新規タスクを挿入する THEN システムは ワンクリックで挿入ポイントを選択でき、階層番号を自動的に再採番する
12. WHILE WBSを表示している THE システムは エクセルライクなテーブル表示で、列幅の調整機能と印刷対応のレイアウトを提供する
13. WHEN WBSで整数番号（1,2,3,4など）のタスクを表示する THEN システムは 整数番号のタスクのみを色分けして強調表示し、新規タスク作成ボタンでは整数番号のみ作成可能とする
14. WHEN ユーザーがタスクを削除する THEN システムは 整数番号タスクを削除した場合、その子タスク（小数番号）も一括削除し、タスクの順序変更時は自動的に階層番号を再採番する

### 要件3: カンバンボード機能
**ユーザーストーリー:** チームメンバーとして、タスクの進捗状況を視覚的に把握したい。そのため、ドラッグ&ドロップで簡単にステータスを変更できるカンバンボードが必要だ。

#### 受け入れ基準

1. WHEN ユーザーがカンバンボードを開く THEN システムは 「ToDo」「進行中」「完了」の3つの基本レーンを表示する
2. WHEN ユーザーが新規レーンを追加する THEN システムは カスタムレーン名を入力できるフォームを表示する
3. WHEN ユーザーがカードをレーン間でドラッグする THEN システムは カードの状態を更新し、移動履歴を記録する
4. IF レーンに設定されたWIP制限を超える THEN システムは 警告を表示し、カードの追加を制限する
5. WHERE カードに期限が設定されている THE システムは 期限までの残り日数を表示する
6. WHEN ユーザーがカードにラベルを追加する THEN システムは 色分けされたラベルを表示し、フィルタリングを可能にする
7. WHILE カンバンボードを表示している THE システムは 各レーンのカード数を集計して表示する

### 要件4: ガントチャート機能
**ユーザーストーリー:** プロジェクトマネージャーとして、タスクのスケジュールと依存関係を時系列で可視化したい。そのため、インタラクティブなガントチャートが必要だ。

#### 受け入れ基準

1. WHEN ユーザーがガントチャートを開く THEN システムは 現在の月を中心とした時間軸とタスク一覧を表示する
2. WHEN ユーザーがタスクバーをドラッグする THEN システムは 開始日と終了日を更新し、依存関係を維持する
3. IF タスクAがタスクBに依存している AND タスクBの日程が変更される THEN システムは タスクAの日程を自動調整する
4. WHERE クリティカルパス上のタスクである THE システムは タスクバーを赤色で強調表示する
5. WHEN ユーザーがタスク間に依存関係を設定する THEN システムは 矢印で依存関係を視覚的に表示する
6. WHILE ガントチャートを表示している THE システムは 今日の日付を縦線で表示する
7. WHEN ユーザーが表示期間を変更する THEN システムは 日/週/月/四半期の表示を切り替える
8. WHEN ユーザーがタスクにアイコンを設定する THEN システムは フォルダ、ドキュメント、人物などのアイコンをタスク名の横に表示する
9. WHEN ユーザーがタスクに色を設定する THEN システムは 赤、青、緑、黄、紫などの色でガントバーを表示する
10. WHERE タスクに親子関係がある THE システムは 階層構造を視覚的に表示し、子タスクをインデントする
11. WHEN ユーザーがビューを切り替える THEN システムは ガントチャート、リスト、カンバン、カレンダービューを切り替える
12. WHEN ユーザーがタスクにメンバーを割り当てる THEN システムは 担当者のアイコンをタスク名の横に表示する
13. WHERE タスクがグループに属している THE システムは 背景色でグループを区別して表示する
14. WHEN ユーザーがツールバーを使用する THEN システムは メンバー管理、ステータス管理、通知管理の機能を提供する
15. WHILE ガントチャートを表示している THE システムは カレンダーヘッダーに年月と日付を明確に表示する

### 要件5: データ永続化とセキュリティ
**ユーザーストーリー:** 個人ユーザーとして、会員登録なしで安全にデータを保存したい。そのため、ローカルストレージを活用した永続化機能が必要だ。

#### 受け入れ基準

1. WHEN ユーザーがデータを作成・更新する THEN システムは 即座にローカルストレージに保存する
2. WHEN ユーザーがブラウザを再起動する THEN システムは ローカルストレージからデータを復元する
3. IF ローカルストレージの容量が不足する THEN システムは 警告メッセージを表示し、古いデータの削除を提案する
4. WHEN ユーザーがエクスポート機能を使用する THEN システムは JSON形式でデータをダウンロード可能にする
5. WHEN ユーザーがインポート機能を使用する THEN システムは JSONファイルからデータを読み込み、既存データとマージする
6. WHERE 機密情報が含まれる可能性がある THE システムは データを暗号化してローカルストレージに保存する
7. WHEN ユーザーがデータをクリアする THEN システムは 確認ダイアログを2回表示し、誤操作を防ぐ

### 要件6: ユーザーインターフェース
**ユーザーストーリー:** 一般職の利用者として、専門知識なしで直感的に操作したい。そのため、わかりやすく統一されたUIが必要だ。

#### 受け入れ基準

1. WHEN ユーザーが初めてアプリを開く THEN システムは 簡単なチュートリアルを表示する
2. WHERE ユーザーが操作に迷う可能性がある THE システムは ツールチップでヒントを表示する
3. WHEN ユーザーがダークモードを選択する THEN システムは 全画面のテーマを切り替え、設定を保存する
4. IF ユーザーがモバイルデバイスでアクセスする THEN システムは レスポンシブデザインで最適化された表示を行う
5. WHILE ユーザーが長時間の操作を行っている THE システムは 自動保存インジケーターを表示する
6. WHEN ユーザーがキーボードショートカットを使用する THEN システムは 主要な操作を素早く実行する
7. WHERE エラーが発生した THE システムは ユーザーフレンドリーなメッセージと解決方法を表示する

### 要件6: 統合連携機能
**ユーザーストーリー:** スケジュール管理者として、Todo、WBS、カンバン、ガントチャートを一元的に管理したい。そのため、各ツール間でデータが自動的に連携し、どのビューからでも同じタスクを管理できる統合機能が必要だ。

#### 受け入れ基準

1. WHEN ユーザーがTodoでタスクを作成する THEN システムは 必要に応じてWBS、カンバン、ガントチャートにも同じタスクを表示する
2. WHEN ユーザーがWBSの最下層タスクを作成する THEN システムは 自動的にTodoリストにも追加し、期限が設定されていればガントチャートにも表示する
3. WHEN ユーザーがカンバンでカードのステータスを変更する THEN システムは 関連するTodoの完了状態、WBSの進捗率、ガントチャートの進捗を自動更新する
4. WHEN ユーザーがガントチャートで日程を変更する THEN システムは 関連するTodoの期限、WBSの開始日・終了日を自動更新する
5. WHERE タスクが複数のビューに表示されている THE システムは 各ビューに適したアイコンまたはバッジでリンク状態を表示する
6. WHEN ユーザーが統合検索を使用する THEN システムは すべてのビューのタスクを横断的に検索し、結果を統合して表示する
7. IF ユーザーがタスクをドラッグ&ドロップで別のビューに移動する THEN システムは 適切なデータ変換を行い、新しいビューに追加する
8. WHEN ユーザーがフィルタを適用する THEN システムは 現在のビューに関わらず、統一されたフィルタ条件（ステータス、優先度、担当者、期限）で絞り込む

### 要件7: 統合UI/UX
**ユーザーストーリー:** 一般ユーザーとして、異なるツール間をシームレスに移動したい。そのため、統一されたナビゲーションと一貫性のあるUIが必要だ。

#### 受け入れ基準

1. WHEN ユーザーがアプリケーションを開く THEN システムは 上部に統合ナビゲーションタブ（Todo｜WBS｜カンバン｜ガント）を表示する
2. WHEN ユーザーがタブを切り替える THEN システムは 0.3秒以内に新しいビューを表示し、選択状態を保持する
3. WHERE すべてのビューで THE システムは 共通のサイドバーでプロジェクト一覧、フィルタ、タグ、メンバー、カレンダーを表示する
4. WHEN ユーザーがタスクの詳細を開く THEN システムは 統一されたダイアログで、基本情報、関連、履歴、コメントのタブを表示する
5. IF ユーザーがタスクを右クリックする THEN システムは コンテキストメニューで他のビューへの追加オプションを表示する
6. WHILE ユーザーが操作している THE システムは リアルタイムで変更を保存し、他のビューにも即座に反映する
7. WHEN ユーザーが通知アイコンをクリックする THEN システムは 期限通知、ステータス変更通知などを統合して表示する

### 要件8: 統合データ管理
**ユーザーストーリー:** データ管理者として、すべてのタスクデータを一元的に管理したい。そのため、統一されたデータモデルと効率的な同期メカニズムが必要だ。

#### 受け入れ基準

1. WHEN システムがタスクを保存する THEN システムは 統一されたデータモデル（UnifiedTask）で、すべての属性を管理する
2. WHERE データ競合が発生した場合 THE システムは 最後の更新を優先し、変更履歴を保持する
3. WHEN ユーザーがデータをエクスポートする THEN システムは JSON、CSV、Excel形式で統合データを出力する
4. WHEN ユーザーがデータをインポートする THEN システムは 自動的にデータを解析し、適切なビューに振り分ける
5. IF データベースのサイズが50MBを超える THEN システムは 古いアーカイブデータの削除を提案する
6. WHILE システムが稼働している THE システムは データの整合性チェックを定期的に実行する
7. WHEN ユーザーが削除操作を行う THEN システムは 関連するすべてのビューからタスクを削除し、依存関係を自動調整する