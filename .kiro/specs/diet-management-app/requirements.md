# 要件仕様書

## 概要
ユーザーの健康的なダイエットと体重管理をサポートするモバイルアプリケーション。食事記録、カロリー計算、体重追跡、目標設定などの機能を通じて、ユーザーが継続的に健康管理を行えるプラットフォームを提供する。

## 要件

### 要件1: ユーザー登録・プロフィール管理
**ユーザーストーリー:** ダイエットを始めたいユーザーとして、個人情報と目標を登録できるようにしたい。そうすることで、パーソナライズされたダイエットプランを利用できる。

#### 受入条件
1. WHEN ユーザーが初回起動時 THEN 年齢、性別、身長、現在体重、目標体重の入力画面が表示される
2. WHEN 必須項目がすべて入力された THEN アカウント作成が完了し、メイン画面に遷移する
3. WHEN 身長・体重に数値以外が入力された THEN エラーメッセージが表示され、正しい形式での入力を促す
4. IF 目標体重が現在体重より極端に異なる（±30kg以上） THEN 警告メッセージを表示し、確認を求める

### 要件2: 食事記録・カロリートラッキング
**ユーザーストーリー:** ダイエット中のユーザーとして、毎日の食事内容とカロリーを簡単に記録したい。そうすることで、摂取カロリーを把握し、食生活を改善できる。

#### 受入条件
1. WHEN ユーザーが「食事を追加」ボタンをタップ THEN 朝食・昼食・夕食・間食の選択画面が表示される
2. WHEN 食材名を入力して検索 THEN カロリーデータベースから該当する食材リストが表示される
3. WHEN 食材と分量を選択 THEN 自動的にカロリーが計算され、その日の合計摂取カロリーに加算される
4. WHEN その日の摂取カロリーが目標カロリーを超過 THEN 警告表示でユーザーに通知する
5. IF 存在しない食材を入力 THEN 「該当する食材が見つかりません」メッセージを表示し、手動カロリー入力オプションを提供する

### 要件3: 体重記録・進捗追跡
**ユーザーストーリー:** ダイエット中のユーザーとして、定期的に体重を記録し、進捗を可視化したい。そうすることで、ダイエットの効果を実感し、モチベーションを維持できる。

#### 受入条件
1. WHEN ユーザーが「体重記録」を選択 THEN 数値入力フィールドと日付選択が表示される
2. WHEN 体重を入力して保存 THEN データがグラフに反映され、前回からの変化量が表示される
3. WHEN 体重グラフを表示 THEN 過去30日間の体重推移が折れ線グラフで表示される
4. WHEN 目標達成まで残り1kg以下 THEN 「もう少しで目標達成！」のメッセージを表示する
5. IF 前回記録から体重が急激に変化（±3kg以上） THEN 「体重の変化が大きいです。正しい値ですか？」の確認ダイアログを表示する

### 要件4: 目標設定・管理
**ユーザーストーリー:** ダイエット継続中のユーザーとして、目標体重や目標期間を設定・変更したい。そうすることで、現実的なペースでダイエットを続けられる。

#### 受入条件
1. WHEN ユーザーが設定画面で目標を変更 THEN 目標体重、目標達成日、週間減量ペースの設定が可能
2. WHEN 新しい目標を保存 THEN 1日の推奨摂取カロリーが自動再計算される
3. WHEN 目標達成予定日を表示 THEN 現在のペースでの到達予想日が表示される
4. WHEN 非現実的な目標が設定された THEN 「健康的なペースは週0.5-1kgです」の注意メッセージを表示する
5. IF 目標期間が1週間未満 THEN エラーメッセージを表示し、最低2週間以上の設定を促す

### 要件5: データ可視化・レポート
**ユーザーストーリー:** ダイエット管理をしているユーザーとして、過去の記録をグラフやレポートで確認したい。そうすることで、自分のダイエットパターンを分析し、改善点を見つけられる。

#### 受入条件
1. WHEN レポート画面を開く THEN 週間・月間・全期間の表示切り替えが可能
2. WHEN 週間レポートを選択 THEN 7日間の体重変化、平均摂取カロリー、目標達成日数が表示される
3. WHEN 月間レポートを選択 THEN 月間の体重減少量、カロリー収支グラフ、達成率が表示される
4. WHEN グラフの任意の点をタップ THEN その日の詳細な食事記録が表示される
5. IF データが不足している期間 THEN 「記録が不足しています」のメッセージを表示し、継続記録を促す

### 要件6: 通知・リマインダー機能
**ユーザーストーリー:** 忙しいユーザーとして、食事記録や体重測定を忘れないように通知してほしい。そうすることで、記録の習慣を継続できる。

#### 受入条件
1. WHEN ユーザーが通知設定を有効化 THEN 朝・昼・夕の食事時間と体重測定時間の設定が可能
2. WHEN 設定時刻になった THEN プッシュ通知で記録を促すメッセージが送信される
3. WHEN 3日間記録がない THEN 「最近記録していませんね」の継続を促す通知を送信する
4. WHEN 目標達成時 THEN お祝いメッセージの通知を送信する
5. IF 通知許可が拒否されている THEN アプリ内でリマインダーバナーを表示する

### 要件7: ユーザーインターフェース・操作性
**ユーザーストーリー:** スマートフォンを使うユーザーとして、直感的で使いやすいインターフェースでアプリを操作したい。そうすることで、毎日ストレスなく記録を続けられる。

#### 受入条件
1. WHEN アプリを起動 THEN 3秒以内にメイン画面が表示される
2. WHEN 任意の入力フィールドをタップ THEN 適切なキーボード（数値・文字）が表示される
3. WHEN 画面を縦・横に回転 THEN レイアウトが適切に調整される
4. WHEN オフライン状態 THEN ローカルに一時保存され、オンライン復帰時に同期される
5. IF 入力エラーが発生 THEN エラー箇所を赤色でハイライトし、修正方法を明示する

### 要件8: データ管理・セキュリティ
**ユーザーストーリー:** 個人的な健康データを記録するユーザーとして、データが安全に保管・管理されることを確信したい。そうすることで、安心してアプリを継続利用できる。

#### 受入条件
1. WHEN ユーザーデータを保存 THEN 暗号化されてローカルストレージに保存される
2. WHEN アプリを削除・再インストール THEN データバックアップ・復元オプションが利用可能
3. WHEN 不正なアクセスを検知 THEN アプリロック機能でデータを保護する
4. WHEN データを削除 THEN 「この操作は取り消せません」の確認ダイアログを表示する
5. IF システムエラーが発生 THEN エラーログを記録し、ユーザーには分かりやすいメッセージを表示する