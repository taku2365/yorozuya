# 要件書

## はじめに

このアプリケーションは、画像内の人物の顔を自動検出し、プライバシー保護のためにモザイク処理を施す画像処理アプリケーションです。ユーザーが画像をアップロードすると、AIが顔を検出し、自動的にモザイク効果を適用して、個人のプライバシーを保護した画像を出力します。

**ビジネス価値**: プライバシー保護が重要視される現代において、SNS投稿、ブログ記事、レポート作成時などで個人の顔を簡単に匿名化できる便利なツールを提供します。

## 要件

### 要件1: 画像入力機能
**ユーザーストーリー:** ユーザーとして、処理したい画像を簡単にアップロードできるようにしたい。そうすることで、顔検出・モザイク処理を開始できるから。

#### 受入基準

1. WHEN ユーザーが画像ファイルを選択する THEN システムは JPEGまたはPNG形式の画像ファイルを受け入れなければならない
2. WHEN ユーザーが対応していないファイル形式をアップロードする THEN システムは「対応していないファイル形式です。JPEGまたはPNG形式の画像を選択してください」というエラーメッセージを表示しなければならない
3. WHEN ユーザーが10MB以上のファイルをアップロードする THEN システムは「ファイルサイズが大きすぎます。10MB以下の画像を選択してください」というエラーメッセージを表示しなければならない
4. WHEN 画像のアップロードが成功する THEN システムは画像のプレビューとファイル名を表示しなければならない
5. IF 画像のアップロードが進行中である THEN システムは進行状況インジケーターを表示しなければならない

### 要件2: 顔検出機能
**ユーザーストーリー:** ユーザーとして、アップロードした画像から人物の顔が自動的に検出されることを期待する。そうすることで、手動で顔の位置を指定する手間が省けるから。

#### 受入基準

1. WHEN 画像に人物の顔が含まれている THEN システムは顔の位置を正確に検出しなければならない
2. WHEN 画像に複数の顔が含まれている THEN システムは全ての顔を検出しなければならない
3. WHEN 画像に顔が検出されない THEN システムは「顔が検出されませんでした」というメッセージを表示しなければならない
4. WHEN 顔検出処理が完了する THEN システムは検出された顔の数を「○個の顔を検出しました」として表示しなければならない
5. IF 顔検出処理が進行中である THEN システムは「顔を検出中...」という進行状況を表示しなければならない
6. WHEN 顔検出が完了する THEN システムは検出された顔の周囲に識別用の枠を表示しなければならない

### 要件3: モザイク処理機能
**ユーザーストーリー:** ユーザーとして、検出された顔に適切なモザイク効果が適用されることを期待する。そうすることで、個人のプライバシーが確実に保護されるから。

#### 受入基準

1. WHEN 顔が検出される THEN システムは検出された全ての顔にモザイク効果を適用しなければならない
2. WHEN モザイク処理を実行する THEN システムは顔の形状に合わせてモザイクを適用しなければならない
3. WHEN モザイク処理が完了する THEN システムは元の顔が判別できないレベルのモザイク強度を適用しなければならない
4. IF ユーザーがモザイク強度を調整可能である THEN システムは「弱」「中」「強」の3段階でモザイク強度を選択できなければならない
5. WHEN ユーザーがモザイク強度を変更する THEN システムはリアルタイムでプレビューを更新しなければならない
6. IF モザイク処理が進行中である THEN システムは「モザイク処理中...」という進行状況を表示しなければならない

### 要件4: 結果出力機能
**ユーザーストーリー:** ユーザーとして、モザイク処理された画像をダウンロードできるようにしたい。そうすることで、処理済み画像を他の用途で使用できるから。

#### 受入基準

1. WHEN モザイク処理が完了する THEN システムは処理済み画像のプレビューを表示しなければならない
2. WHEN ユーザーがダウンロードボタンをクリックする THEN システムは処理済み画像をユーザーのデバイスにダウンロードさせなければならない
3. WHEN 画像をダウンロードする THEN システムは元の画像と同じ解像度を維持しなければならない
4. WHEN 画像をダウンロードする THEN システムはファイル名に「_mosaic」サフィックスを追加しなければならない
5. IF ダウンロード処理が進行中である THEN システムは「ダウンロード準備中...」という状況を表示しなければならない

### 要件5: ユーザーインターフェース
**ユーザーストーリー:** ユーザーとして、直感的で使いやすいインターフェースを通じて操作したい。そうすることで、技術的な知識がなくても簡単に顔モザイク処理ができるから。

#### 受入基準

1. WHEN ユーザーがアプリにアクセスする THEN システムは分かりやすい操作手順を画面に表示しなければならない
2. WHEN 処理の各段階において THEN システムは現在の進行状況を明確に表示しなければならない
3. WHEN エラーが発生する THEN システムは具体的で理解しやすいエラーメッセージを表示しなければならない
4. IF ユーザーが操作を間違える THEN システムは適切なガイダンスを提供しなければならない
5. WHEN 新しい画像を処理したい THEN システムは「新しい画像を処理」ボタンでリセット機能を提供しなければならない
6. WHERE モバイルデバイスでアクセスする場合 THE SYSTEM SHALL レスポンシブデザインでタッチ操作に最適化された画面を表示しなければならない

### 要件6: 性能・品質要件
**ユーザーストーリー:** ユーザーとして、合理的な時間内で高品質な処理結果を得たい。そうすることで、実用的なツールとして日常的に使用できるから。

#### 受入基準

1. WHEN 2MB以下の画像を処理する THEN システムは30秒以内に全ての処理を完了しなければならない
2. WHEN 顔検出を実行する THEN システムは95%以上の精度で人物の顔を検出しなければならない
3. WHEN 同時に複数のユーザーがアクセスする THEN システムは安定した性能を維持しなければならない
4. IF 処理に予想以上の時間がかかる THEN システムは「処理に時間がかかっています。しばらくお待ちください」というメッセージを表示しなければならない
5. WHEN アプリが使用される THEN システムは処理中も応答性の高いユーザーインターフェースを維持しなければならない